//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
#include "Tree.h"
#include "MyTask6.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}

void __fastcall TForm1::InitialStringGridSelectCell(TObject *Sender, int ACol, int ARow,
		  bool &CanSelect)
{
	CanSelect = false;
}

//при создании формы
void __fastcall TForm1::FormCreate(TObject *Sender)
{
	InitialStringGrid->Cells[0][0] = "Ф.И.О.";
	InitialStringGrid->Cells[1][0] = "Ключ";
	InitialStringGrid->Cells[0][1] = "Пушкин А.С.";
	InitialStringGrid->Cells[1][1]="7";
	InitialStringGrid->Cells[0][2] = "Толстой Л.Н.";
	InitialStringGrid->Cells[1][2]="2";
	InitialStringGrid->Cells[0][3] = "Чехов А.П.";
	InitialStringGrid->Cells[1][3]="6";
	InitialStringGrid->Cells[0][4] = "Гоголь Н.В.";
	InitialStringGrid->Cells[1][4]="9";
	InitialStringGrid->Cells[0][5] = "Лермонтов М.Ю.";
	InitialStringGrid->Cells[1][5]="5";
	InitialStringGrid->Cells[0][6] = "Достоевский Ф.М.";
	InitialStringGrid->Cells[1][6]="12";
	InitialStringGrid->Cells[0][7] = "Есенин С.А.";
	InitialStringGrid->Cells[1][7]="4";
	InitialStringGrid->Cells[0][8] = "Тютчев Ф.И.";
	InitialStringGrid->Cells[1][8]="8";
	InitialStringGrid->Cells[0][9] = "Маяковский В.В.";
	InitialStringGrid->Cells[1][9]="10";
	InitialStringGrid->Cells[0][10] = "Тургенев И.С.";
	InitialStringGrid->Cells[1][10]="1";
}

Tree *tree;
TTree *root;

//Кнопка "Создать (из массива)"
void __fastcall TForm1::Button1Click(TObject *Sender)
{
	ShowTreeTreeView->Items->Clear();
	ShowInfMemo->Clear();
	tree->AddArrayToTree(&root, InitialStringGrid);
}

//Кнопка "Сбалансировать"
void __fastcall TForm1::Button2Click(TObject *Sender)
{
    if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else
	{
		ShowTreeTreeView->Items->Clear();
		ShowInfMemo->Clear();
		int size = tree->ListCount(root);
		TInf *array = new TInf[size];
		tree->ReturnBallanced(&root, size, array);
		delete[] array;
		tree->ViewTree(root, -1, ShowTreeTreeView);
		ShowTreeTreeView->FullExpand();
	}

}

//Кнопка "Добавить"
void __fastcall TForm1::Button3Click(TObject *Sender)
{
	AnsiString str = EnterFioEdit->Text;
	if (EnterKeyEdit->Text == "" || str == "")
	{
		Application->Title = "ОШИБКА";
		ShowMessage("Введите данные для добавления!");
	}
	else if(str[1] == ' ')
	{
		EnterFioEdit->Text = "";
        Application->Title = "ОШИБКА";
		ShowMessage("Введите данные для добавления!");
    }
	else
	{
		TInf inf;
		inf.key = StrToInt(EnterKeyEdit->Text);
		inf.fio = EnterFioEdit->Text;
		tree->AddList(&root, inf);
		EnterKeyEdit->Text = "";
		EnterFioEdit->Text = "";
		ShowTreeTreeView->Items->Clear();
		ShowInfMemo->Clear();
	}
}

//Кнопка "Удалить (по ключу)"
void __fastcall TForm1::Button5Click(TObject *Sender)
{
	if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else if(EnterKeyEdit->Text == "")
	{
		Application->Title = "ОШИБКА";
		ShowMessage("Введите ключ для удаления!");
	}
	else
	{
		root = tree->DelInfo(root, StrToInt(EnterKeyEdit->Text));
		EnterKeyEdit->Text = "";
		ShowTreeTreeView->Items->Clear();
		ShowInfMemo->Clear();
	}
}

//Кнопка "Найти (по ключу)"
void __fastcall TForm1::Button4Click(TObject *Sender)
{
    if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else if(EnterKeyEdit->Text == "")
	{
		Application->Title = "ОШИБКА";
		ShowMessage("Введите ключ для поиска!");
	}
	else
	{
		ShowTreeTreeView->Items->Clear();
		ShowInfMemo->Clear();
		tree->SearchInfo(root, StrToInt(EnterKeyEdit->Text), ShowInfMemo);
        EnterKeyEdit->Text = "";
	}
}

//Кнопка "В TreeView"
void __fastcall TForm1::Button6Click(TObject *Sender)
{
	if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else
	{
		ShowTreeTreeView->Items->Clear();
		ShowInfMemo->Clear();
		tree->ViewTree(root, -1, ShowTreeTreeView);
		ShowTreeTreeView->FullExpand();
	}
}

//Кнопка "Прямой обход"
void __fastcall TForm1::Button7Click(TObject *Sender)
{
	if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else
	{
		ShowInfMemo->Clear();
		tree->PrPrintTree(&root, ShowInfMemo);
	}
}

//Кнопка "Обратный обход"
void __fastcall TForm1::Button8Click(TObject *Sender)
{
    if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else
	{
		ShowInfMemo->Clear();
		tree->ObPrintTree(&root, ShowInfMemo);
	}
}

//Кнопка "Симметричный обход"
void __fastcall TForm1::Button9Click(TObject *Sender)
{
	if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else
	{
		ShowInfMemo->Clear();
		tree->SimPrintTree(&root, ShowInfMemo);
	}
}

//Кнопка "Свой вариант"
void __fastcall TForm1::MyTaskButtonClick(TObject *Sender)
{
    if(root == NULL)
	{
		Application->Title = "ВНИМАНИЕ";
		ShowMessage("В дереве нет элементов!");
	}
	else
	{
		Application->Title = "УСЛОВИЕ";
		ShowMessage("6. Удалить из левой ветви дерева узел с максимальным"
			" значением ключа и все связанные с ним узлы."
			"\n\nДанное задание можно понимать двояко:"
			"\n1. Удалить ЦЕЛИКОМ поддерево с \"корнем\" в max узле;"
			"\n2. Удалить ТОЛЬКО непосредственно \"связанные с ним узлы\" - значит"
			" только левый (т.к. если у узла есть правый, то он не максимальный)."
			"\n\nДанная кнопка реализует 1 вариант (2 вариант реализует закоменти"
			"рованная идентичная по названию функция в том же классе MyTask)");
		ShowTreeTreeView->Items->Clear();
		ShowInfMemo->Clear();
		MyTask *myTask;
		myTask->DeleteMaxLeftWithConnected(&root, ShowInfMemo);
		tree->ViewTree(root, -1, ShowTreeTreeView);
		ShowTreeTreeView->FullExpand();
	}
}

//Кнопка "Выход"
void __fastcall TForm1::Button11Click(TObject *Sender)
{
	tree->DeleteTree(&root);
	ShowInfMemo->Clear();
	ShowTreeTreeView->Items->Clear();
	Close();
}

